---
title: Режим "Только чтение" в Windows-приложениях
sidebar: flexberry-winforms_sidebar
keywords: DataObject (объекты данных), Windows UI (формы)
toc: true
permalink: ru/fw_readonly-win.html
folder: products/flexberry-winforms/
lang: ru
---

Объект, открытый в режиме "Только чтение" (Read-only) не может быть изменен пользователем, данные, хранящиеся в объекте, будут доступны только для чтения.

Режим `ReadOnly` может понадобиться в разных ситуациях, к примеру
* Один пользователь открыл объект на редактирование, в это время другой пользователь пытается также открыть этот же объект на редактирование.
* У пользователя нет прав изменять какое-либо поле объекта, или сам объект, но есть право просматривать данные.

## Составляющие режима ReadOnly
Режим можно условно поделить на 3 составляющие:

* Блокировка интерфейса пользователя
* Блокировка объекта данных в памяти приложения
* Блокировка объекта данных в базе данных

### Блокировка интерфейса пользователя

Если пользователь не может вносить изменения в объект, он должен это осознавать в момент открытия формы редактирования. Если объект в данный момент недоступен из-за блокировки другим пользователем, рекомендуется вывести предупреждение типа "Объект заблокирован другим пользователем. Вы желаете открыть объект только на чтение? Да\Нет". Если пользователь все же желает открыть объект в режиме ReadOnly, необходимо заблокировать контролы для редактирования полей объекта. Также необходимо скрыть кнопки `Сохранить` и `Сохранить и закрыть` (только для случая полной блокировки, а не блокировки отдельных полей объекта).

Для блокировки интерфейса пользователя в Windows-приложениях используется класс [EditManager](edit-manager.html).

EditManager позволяет либо заблокировать объект полностью, либо заблокировать только некоторые его поля.

__Важно__: Стоит отметить, что EditManager блокирует только те поля объекта, которые зарегистрированы в EditManager'e.

* Полная блокировка объекта через EditManager осуществляется установкой свойства 

```csharp
 EditManager.ReadOnly = true; 
```

* Частичная блокировка объекта (блокировка отдельных полей) осуществляется вызовом метода [EditManager.SetReadonlyFlagProperties](edit-manager-set-readonly-flag-properties.html), подробнее можно почитать в [этой статье](different-applications-and-fields.html).

### Блокировка объекта данных в памяти приложения
Блокировка объекта в памяти осуществляется вызовом метода объекта `DataObject.LockObject(Key)`, где `Key` - некий ключ блокировки типа `Guid`. Разблокировать объект можно ''только этим ключом'' при помощи метода `DataObject.UnLockObject(Key)`.

При вызове метода `LockObject` блокировка в базу не отправляется.

Пример можно посмотреть [ReadOnlyObject.ashx|здесь].

### Блокировка объекта данных в базе данных
Для блокировки используется поддерживаемый технологией [Сервис-блокировок|Сервис блокировок].

Блокировка объекта в базе данных железно защищает объект от изменений объекта другими пользователями. Создается запись в таблице `STORMNETLOCKDATA` и, пока она там существует, изменить объект может только пользователь, заблокировавший объект.

Пример можно посмотреть [Сервис-блокировок|здесь].
