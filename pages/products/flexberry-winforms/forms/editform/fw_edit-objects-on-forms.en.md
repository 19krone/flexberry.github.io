---
title: Editing data objects on forms
sidebar: flexberry-winforms_sidebar
keywords: Controls, Windows
summary: Toggle editable objects, manually creating forms, editing, updating, and performance interaction while editing a feature
toc: true
permalink: en/fw_edit-objects-on-forms.html
lang: en
autotranslated: true
hash: bb36104dc3c44553f6601de15fe886f9c90c9ad7dba8cf0e00680bb71bff53fd
---

Edit the data objects on the forms has a lot of nuances and possibilities. The most common outlined in this article.

## Switching the editable object without closing the edit form

Sometimes the script system involves a sequence viewable or editable objects on the edit form without closing the form. An analogue of this functionality is to view events in the Windows EventLog (EventLog). Flexberry Platform for the organization of this script supports a special feature that is available from independent edit forms: `SwitchEditingObject(newObject)`.
Typical and recommended implementation from the application project can be done in the following way:

* A dependent includes an interface portion for switching the objects (meaning the user interface: buttons and other controls).

* The dependent form contains events that are generated by the interface part (go forward, backward, on the specified object, etc.). The triggering of these events is linked to the corresponding controls. Example:

```csharp
/// <summary> 
/// Delegate for event rewind objects 
/// </summary> 
/// <param name="sender"></param> 
/// <param name="e"></param> 
public delegate void PrevNextEventArgsHandler(object sender, EventArgs e);

//... 
// *** Start programmer edit section *** (WinformПланетаE CustomMembers) 
///<summary> 
/// Forward 
///</summary> 
public event PrevNextEventArgsHandler NextEvent;
/// <summary> 
/// Rewind 
/// </summary> 
public event PrevNextEventArgsHandler PrevEvent;

private void button1_Click(object sender, EventArgs e)
{
    if (NextEvent != null)
    {
        NextEvent(this, e);
    }
}

private void button2_Click(object sender, EventArgs e)
{
    if (PrevEvent != null)
    {
        PrevEvent(this, e);
    }
}

// *** End programmer edit section *** (WinformПланетаE CustomMembers) 
```

* Independent form sees these events, but through the interface (after the code class independent Flexberry generates an interface to define event methods and attributes dependent form)

```csharp
/// <summary> 
/// this interface definition, which is inherited by the dependent form, but it is in the file independent 
/// </summary> 
public interface DPDIПланетаE
{

    // *** Start programmer edit section *** (DPDIПланетаE Members) 
    ///<summary> 
    /// Forward 
    ///</summary> 
    event PrevNextEventArgsHandler NextEvent;
    /// <summary> 
    /// Rewind 
    /// </summary> 
    event PrevNextEventArgsHandler PrevEvent;

    // *** End programmer edit section *** (DPDIПланетаE Members) 

}
```

* Independent form subscribes to these additional events dependent forms in a special method `prv_AttachEventsFromDpdForm(object form)`

```csharp
protected virtual void prv_AttachEventsFromDpdForm(object form)
{
    // *** Start programmer edit section *** (prv_AttachEventsFromDpdForm( object form )) 
    IIS.AlteredHierarchy.DPDIПланетаE form1 = ((IIS.AlteredHierarchy.DPDIПланетаE)(form));
    form1.NextEvent -= new PrevNextEventArgsHandler(form1_NextEvent);
    form1.NextEvent += new PrevNextEventArgsHandler(form1_NextEvent);

    form1.PrevEvent -= new PrevNextEventArgsHandler(form1_PrevEvent);
    form1.PrevEvent += new PrevNextEventArgsHandler(form1_PrevEvent);

    // *** End programmer edit section *** (prv_AttachEventsFromDpdForm( object form )) 
    IIS.AlteredHierarchy.DPDIПланетаE typedForm = ((IIS.AlteredHierarchy.DPDIПланетаE)(form));
}

//... 
// *** Start programmer edit section *** (Planete CustomMembers) 
void form1_PrevEvent(object sender, EventArgs e)
{
    GetNextOrPrevObj(false);
}

void form1_NextEvent(object sender, EventArgs e)
{
    GetNextOrPrevObj(true);
}

/// <summary> 
/// An example of a method that gets the previous or next object and changes the object that we are editing 
/// </summary> 
/// <param name="next"></param> 
private void GetNextOrPrevObj(bool next)
{
    KeyGuid pk = (KeyGuid)((BaseWinEdit)Editor).DataObject.__PrimaryKey;
    IDataService ds = DataServiceProvider.DataService;

    LoadingCustomizationStruct lcs = LoadingCustomizationStruct.GetSimpleStruct(typeof(Планета), "Planetae");
    lcs.ColumnsSort = new[] { new ColumnsSortDef("primaryKey", SortOrder.Asc) };
    lcs.ReturnTop = 1;
    SQLWhereLanguageDef lDef = SQLWhereLanguageDef.LanguageDef;
    Function f = lDef.GetFunction(next ? lDef.funcG : lDef.funcL, new VariableDef(lDef.GuidType, "StormMainObjectKey"), pk);
    lcs.LimitFunction = f;
    DataObject[] dataObjects = ds.LoadObjects(lcs);
    if (dataObjects.Length > 0)
    {
        DataObject dataObject = dataObjects[0];
        //dataObject.LockObject("AnyKey"); Uncomment if the view in read-only mode 

        SwitchEditingObject(dataObject);
    }
}
// *** End programmer edit section *** (Planete CustomMembers) 
```

When you switch object logic works, the same logic close a form relevant to the request for saving a modified object, clearing the lock. Then everything works the same as the opening: checked lock, is installed or is proposed to open in read-only mode. If the user refuses to open a locked object read-only, then form tries to open the previous object completely by running logic on opening (in a method `PrepareDataObjectForEdit(ICSSoft.STORMNET.DataObject dobject)` happens zachitka object, if this logic is not overridden).

## Update the local copy of the object form

When the form is opened for editing, it creates a local copy of the object. The issue of conservation is set when the difference between this local copy and the edited data object.

There are situations when the object in the database has changed while editing a shape, i.e. a local copy of the form is outdated. In this situation, you should update your local copy of the form by calling the method `ResetDataObjectCopy` independent form. As a parameter of the method is passed the object that will now be a local copy of the form.

## Create edit form object

There are several ways to "manually" create the edit form of the object with the ability to associate it with the properties of an existing data object.

### Linking via program code

1.Place necessary controls on форме;

2.Create an instance of the class `ICSSoft.STORMNET.Windows.Forms.Binders.EditManager` (Manager editing is a specialized class for continuous binding controls to properties of the data object).

Designer required parameter is the data class that is configured in Manager edit.

Primer:_

```csharp
em = new StormNetForms.Binders.EditManager(typeof(CDDD));
```

3.To link controls to properties of the data object.

It is necessary to cause [EditManager](fw_editmanager.html) method `AddControl`. The parameters are passed: the structure `ICSSoft.STORMNET.Windows.Forms.Binders.ControlForBindStruct`.

Primary associate a control with a property of the data object:_

```csharp
em.AddControl(new StormNetForms.Binders.ControlForBindStruct(txtName, "Text"), "Name");
em.AddControl(new StormNetForms.Binders.ControlForBindStruct(txtCapacity, "Text"), "Volume");
```

4.To set a property `EditManager.DataObject` the data object that you want to edit.

After performing these steps, the controls will be connected to the properties of object data through `EditManager`, respectively, when the user will edit the values in the controls at the same time will change the values of the properties of the data object.

If the value of the data object is changed programmatically, to update values on the form need to perform `EditManager.Change`.

`EditManager` has events that allow to determine the values of properties in the data object. This event `BeforeChangePropertyValue` triggered before setting the value and `AfterChangeProperty` triggered after setting the value.

Also, you can associate a manually smeared controls with other controls, providing your `EditManager`, such as `GroupEditBase`, then it is possible to provide the editing values of the data object in the list, via the external controls.

### Binding through the properties

Instead of designing EditManager from the code, it is also possible to throw» «on the form as control and bind the controls with the properties using standard window editing properties in the Visual Studio environment.

If the window edit properties of an EditManager field Bindings.<select view> for some reason, nothing to choose, then the code dependent forms, you can correct the line:

```csharp
this.editManagerMain.Bindings = new ICSSoft.STORMNET.Windows.Forms.Design.Binds("", null, null);
```

in the following, where indicated, with what view works EditManager:

```csharp
this.editManagerMain.Bindings = new ICSSoft.STORMNET.Windows.Forms.Design.Binds("C__Client", typeof(IIS.TryFilter.Клиент), null);
```

Further through the field Bindings.<Add> you need to add the necessary properties of the object, and then in which appears below lines to define their controls from the list. Through the field `Bindings.<Remove>` is possible to delete object properties of binding.

To associate input fields with object properties generated code similar to the following:

```csharp
Binds(string viewname, Type dataobjectType, OneBind[] binds) (параметры для создания объектов класса OneBind аналогичны параметрам структуры ControlForBindStruct).
this.editManagerMain.Bindings = new Binds("C__Client", typeof(IIS.TryFilter.Клиент),
    new ICSSoft.STORMNET.Windows.Forms.Design.OneBind[]
        {
            new OneBind(this.textBoxClientFIO, typeof(System.Windows.Forms.TextBox), "Text", null, "Name"),
            new OneBind(this.textBoxClientAdress, typeof(System.Windows.Forms.TextBox), "Text", null, "Registration")
        });
```

## Work on the editing form with fields for multiple objects

Sometimes faced with the task to organize the work with fields of objects of different classes on one form of editing. For example, the necessary form for a fast input where some fields belongs to one class, part of another, etc. In this case, it is necessary to monitor the preservation of this "complex presentation".

One of the variants of solving this task can be usage of several [EditManager](fw_editmanager.html).

You need to create the objects and bind to them [EditManager](fw_editmanager.html).

The logic of preservation of objects from the "complex representation" depends on the specific task (e.g., what fields to determine that the same object is already in the database how to interpret the change of the stored object, etc.). While maintaining the "complex representation" is necessary to pay attention to the points made in the article:

* [Processing of a set of objects (including different types)](fo_processing-multiple-objects.html)
* [Update related objects](fo_update-related-objects.html)

## Performance interaction when editing features

Basically, the interactions are by call the edit form from the form list (for example, when you open the object for editing), and Vice versa, with the edit form for the list form (for example, to select the associated object). Anyway, the point is that from one form to another is sent to object data and edit it in whole or in part. Accordingly, in a specific (relative) metforminom the interaction of the one form acts as a __initiator__ editing, and the second, — as _the_editor__.

* If an object is opened from the list on the edit form of the list is the initiator, and the edit form editor. In this case, obviously the object is passed to the edit in the edit form.
* If editor to select a related object (craftsman) opens the list form, the edit form is the initiator, and the form list editor.

The difference between cases 1 and 2 only in the fact that in case 2, the object is not edited as a whole, but only part of it.

## Useful links

* [Reads belonging to different object classes in a single view](fo_reading-several-types-objects.html)
* [Uniform field](fw_editform.html)



{% include callout.html content="Переведено сервисом «Яндекс.Переводчик» <http://translate.yandex.ru>" type="info" %}