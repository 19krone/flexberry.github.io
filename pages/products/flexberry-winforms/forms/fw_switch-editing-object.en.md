--- 
title: Switching the object being edited without closing the edit form 
sidebar: flexberry-winforms_sidebar 
keywords: Windows UI (forms) 
summary: as Described in the application code implement the sequential switching of the viewing or editing objects in the edit form without closing the form. Provided the necessary improvements in the code the dependent and independent forms of editing. 
toc: true 
permalink: en/fw_switch-editing-object.html 
folder: products/flexberry-winforms/ 
lang: en 
autotranslated: true 
hash: 9400fdee2f492ab2d7e68a67e428464c5ce01e8e8ffab7e0b8717edee5f848c9 
--- 

Sometimes the script system involves a sequence viewable or editable objects on the edit form without closing the form. An analogue of this functionality is to view events in the Windows EventLog (EventLog). Flexberry Platform for the organization of this script supports a special feature that is available from independent edit forms: `SwitchEditingObject(newObject)`. 
Typical and recommended implementation from the application project can be done in the following way: 

* A dependent includes an interface portion for switching the objects (meaning the user interface: buttons and other controls). 

* The dependent form contains events that are generated by the interface part (go forward, backward, on the specified object, etc.). The triggering of these events is linked to the corresponding controls. Example: 

```csharp
/// <summary> 
/// Delegate for event rewind objects 
/// </summary> 
/// <param name="sender"></param> 
/// <param name="e"></param> 
public delegate void PrevNextEventArgsHandler(object sender, EventArgs e);

//... 
// *** Start programmer edit section *** (WinformПланетаE CustomMembers) 
///<summary> 
/// Forward 
///</summary> 
public event PrevNextEventArgsHandler NextEvent;
/// <summary> 
/// Rewind 
/// </summary> 
public event PrevNextEventArgsHandler PrevEvent;

private void button1_Click(object sender, EventArgs e)
{
    if (NextEvent != null)
    {
        NextEvent(this, e);
    }
}

private void button2_Click(object sender, EventArgs e)
{
    if (PrevEvent != null)
    {
        PrevEvent(this, e);
    }
}

// *** End programmer edit section *** (WinformПланетаE CustomMembers) 
``` 

* Independent form sees these events, but through the interface (after the code class independent Flexberry generates an interface to define event methods and attributes dependent form) 

```csharp
/// <summary> 
/// this interface definition, which is inherited by the dependent form, but it is in the file independent 
/// </summary> 
public interface DPDIПланетаE
{

    // *** Start programmer edit section *** (DPDIПланетаE Members) 
    ///<summary> 
    /// Forward 
    ///</summary> 
    event PrevNextEventArgsHandler NextEvent;
    /// <summary> 
    /// Rewind 
    /// </summary> 
    event PrevNextEventArgsHandler PrevEvent;

    // *** End programmer edit section *** (DPDIПланетаE Members) 

}
``` 

* Independent form subscribes to these additional events dependent forms in a special method `prv_AttachEventsFromDpdForm(object form)` 

```csharp
protected virtual void prv_AttachEventsFromDpdForm(object form)
{
    // *** Start programmer edit section *** (prv_AttachEventsFromDpdForm( object form )) 
    IIS.AlteredHierarchy.DPDIПланетаE form1 = ((IIS.AlteredHierarchy.DPDIПланетаE)(form));
    form1.NextEvent -= new PrevNextEventArgsHandler(form1_NextEvent);
    form1.NextEvent += new PrevNextEventArgsHandler(form1_NextEvent);

    form1.PrevEvent -= new PrevNextEventArgsHandler(form1_PrevEvent);
    form1.PrevEvent += new PrevNextEventArgsHandler(form1_PrevEvent);

    // *** End programmer edit section *** (prv_AttachEventsFromDpdForm( object form )) 
    IIS.AlteredHierarchy.DPDIПланетаE typedForm = ((IIS.AlteredHierarchy.DPDIПланетаE)(form));
}

//... 
// *** Start programmer edit section *** (Planete CustomMembers) 
void form1_PrevEvent(object sender, EventArgs e)
{
    GetNextOrPrevObj(false);
}

void form1_NextEvent(object sender, EventArgs e)
{
    GetNextOrPrevObj(true);
}

/// <summary> 
/// An example of a method that gets the previous or next object and changes the object that we are editing 
/// </summary> 
/// <param name="next"></param> 
private void GetNextOrPrevObj(bool next)
{
    KeyGuid pk = (KeyGuid)((BaseWinEdit)Editor).DataObject.__PrimaryKey;
    IDataService ds = DataServiceProvider.DataService;

    LoadingCustomizationStruct lcs = LoadingCustomizationStruct.GetSimpleStruct(typeof(Планета), "Planetae");
    lcs.ColumnsSort = new[] { new ColumnsSortDef("primaryKey", SortOrder.Asc) };
    lcs.ReturnTop = 1;
    SQLWhereLanguageDef lDef = SQLWhereLanguageDef.LanguageDef;
    Function f = lDef.GetFunction(next ? lDef.funcG : lDef.funcL, new VariableDef(lDef.GuidType, "StormMainObjectKey"), pk);
    lcs.LimitFunction = f;
    DataObject[] dataObjects = ds.LoadObjects(lcs);
    if (dataObjects.Length > 0)
    {
        DataObject dataObject = dataObjects[0];
        //dataObject.LockObject("AnyKey"); Uncomment if the view in read-only mode 

        SwitchEditingObject(dataObject);
    }
}
// *** End programmer edit section *** (Planete CustomMembers) 
``` 

When you switch object logic works, the same logic close a form relevant to the request for saving a modified object, clearing the lock. Then everything works the same as the opening: checked lock, is installed or is proposed to open in read-only mode. If the user refuses to open a locked object read-only, then form tries to open the previous object completely by running logic on opening (in a method `PrepareDataObjectForEdit(ICSSoft.STORMNET.DataObject dobject)` happens zachitka object, if this logic is not overridden). 






{% include callout.html content="Переведено сервисом «Яндекс.Переводчик» <http://translate.yandex.ru>" type="info" %}