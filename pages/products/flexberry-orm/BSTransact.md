---
title: Бизнес-сервер: обновление нескольких объектов одной транзакцией
sidebar: product--sidebar
keywords: Flexberry ORM, Public, Бизнес-серверы
toc: true
permalink: ru/b-s-transact.html
folder: product--folder
lang: ru
---

# Обновление нескольких объектов одной транзакцией
Если возникает необходимость обновить несколько объектов одной транзакцией (к примеру, чтобы поддержать ссылочную целостность), можно воспользоваться стандартным механизмом [бизнес-сервера](business--servers--wrapper--business--facade.html).

# Использование
Для формирования транзакции используются объекты, возвращаемые методом [`OnUpdate`](b-s-example.html) любого бизнес-сервера:
# Создать \ вычитать объекты для транзакции.
# Внести необходимые изменения во все объекты для транзакции (к примеру, проставить ссылки или изменить поля).
# Добавить все объекты транзакции в массив возвращаемых методом элементов.

(((<msg type=Important>Для всех объектов транзакции отработает бизнес-сервер, отвечающий за их обновление (кроме того объекта, из которого была инициирована транзакция).</msg>)))

# Пример
[image||http://storm:3013/GetFile.aspx?File=BSTransactExample.png&AsStreamAttachment=1&Provider=ScrewTurn.Wiki.Plugins.SqlServer.SqlServerFilesStorageProvider&IsPageAttachment=1&Page=BSTransact&NoHit=1]

Предположим, у нас есть два класса, ссылающиеся друг на друга обязательной связью. Стоит задача при создании объекта класса A автоматически создавать объект класса В и проставлять ссылки друг на друга.

# Для начала, необходимо создать бизнес-сервер для класса A и привязть его к обновлению объектов этого класса.
# В методе OnUpdate класса A необходимо написать следующий код:

```
var a = UpdatedObject;
var b = new B();
a.Копия = b;
b.Копия = a;

return new DataObject[2] { a, b }; ```

Теперь, при создании объекта типа А автоматически будет создаваться его копия - объект типа В.

(((<msg type=note>Обратите внимание на изменившийся `return` метода OnUpdate: именно через него формируется список элементов транзкции.</msg>)))

